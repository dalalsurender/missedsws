<!-- <div style="text-align:center">
  <p>token is valid? true/false - {{ token | json }}</p>
</div> -->

<mat-toolbar color="primary">
  <a href="http://www.raleighnc.gov/">
    <img alt="City of Raleigh Logo" class="logo" src="./assets/City-Seal-BW.png">
  </a>
  <span>Solid Waste Services Missed Pickup</span>
  <button mat-icon-button [matMenuTriggerFor]="menu">
    <mat-icon>more_vert</mat-icon>
  </button>
</mat-toolbar>

<mat-menu #menu="matMenu">
  <button mat-menu-item (click)="openDialog('help')">
    <mat-icon>help</mat-icon>
    <span>Need Help?</span>
  </button>
</mat-menu>

<ng-container>
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        <h2>What was missed?</h2>
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form class="example-form" [formGroup]='usersForm' novalidate (ngSubmit)="save(usersForm.value, usersForm.valid)">
        <mat-button-toggle-group name="collectionTypes" formControlName="problemSid">
              <mat-button-toggle *ngFor="let problemSid of problemSids" [value]="problemSid.value">

            {{problemSid.display}}
          </mat-button-toggle>
        </mat-button-toggle-group>
        <div *ngIf="usersForm.controls.problemSid.value == '263551'">
          <p>
            <br />View more information on <a
              href="http://www.raleighnc.gov/home/content/SolidWaste/Articles/GarbagePreparation.html"
              target="_blank">Garbage
              Preparation.</a>
          </p>
        </div>
        <div *ngIf="usersForm.controls.problemSid.value == '263552'">
          <p>
            <br />View more information on <a
              href="http://www.raleighnc.gov/home/content/SolidWaste/Articles/RecyclePages.html"
              target="_blank">Recycling
              Preparation.</a>
          </p>
        </div>
        <div *ngIf="usersForm.controls.problemSid.value == '263553'">
          <p>
            <br />View more information on <a
              href="http://www.raleighnc.gov/home/content/SolidWaste/Articles/GarbagePreparation.html"
              target="_blank">Yard
              Waste Preparation</a>
          </p>
        </div>
        <h3>Enter the Address of the Missed Pickup Location</h3>

        <mat-form-field class="example-full-width">
          <input matInput class="wider" placeholder="Enter your address" [matAutocomplete]="auto" formControlName='addressInput'>
        </mat-form-field>
        <!-- <span>Your choice is: {{usersForm.get('addressInput').value | json}}</span> -->
        <p><span>RecycleDay is: {{ recycleDay | json }}</span></p>
        <p><span>GeoResponse is: {{ geoResponse | json }}</span></p>

        <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
          <mat-option *ngIf="isLoading" class="is-loading">
            <mat-spinner diameter="40"></mat-spinner>
          </mat-option>
          <ng-container *ngIf="!isLoading">
            <mat-option *ngFor="let text of filteredAddresses" [value]="text">
              <span>{{ text.text }}</span>
            </mat-option>
          </ng-container>
        </mat-autocomplete>
      </form>
      <mat-progress-bar *ngIf="!isDone && submitted && !displayHttpError" class="app-progress" mode="indeterminate"
        aria-label="Indeterminate progress-bar example"></mat-progress-bar>
      <div>
        {{displayHttpError}}
      </div>
    </mat-card-content>

    <mat-card-actions style="margin:0 auto;" class="map-mat-card">
      <form class="map-mat-card" [formGroup]="usersForm" novalidate (ngSubmit)="save(usersForm.value, usersForm.valid)">
        <button mat-raised-button color="primary" type="submit" class="btn btn-success"
          [disabled]="!usersForm.valid || isDone">Submit</button>
      </form>
    </mat-card-actions>
  </mat-card>
</ng-container>